#include <stdio.h>
#include <math.h>

int main(int argc, char* argv)
{
	double ts, ta, tb, tvb;
	double ps, pa, pb;
	double at = 150., ap = 14.;

	ps = fabs(1. / (1. + 0.5 * ap));
	pa = fabs(1. / (1. + 0.5 * (ap - 25.)));
	pb = fabs(1. / (1. + 0.5 * (ap - 50.)));

	ts = (1. / 10000.) * (at - 200.) * (at - 200.);
	ta = 1. - ((1. / 1000.) * (125. - at) * (125. - at));
	tb = (1. / 10000.) * (at - 50.) * (at - 50.);
	tvb = tb * tb;

	double proc1, proc2, proc3, proc4;
	proc1 = fmax(fmin(ts, ps), fmin(ts, pa)); proc1 = fmax(proc1, fmin(ta, ps));
	proc2 = fmax(fmin(ts, pb), fmin(tb, ps)); proc2 = fmax(proc2, fmin(ta, pa));
	proc3 = fmax(fmin(ta, pb), fmin(ta, fmax(pa, pb)));
	double tmp = fmax(ps, pa); tmp = fmax(tmp, pb);
	proc4 = fmin(tvb, tmp);

	printf("Температура:\n  sm: %lf\n  av: %lf\n  bg: %lf\n  vb: %lf\n", ts, ta, tb, tvb);
	printf("Давление:\n  sm: %lf\n  av: %lf\n  bg: %lf\n", ps, pa, pb);
	printf("Значение правил:\n  1: %.60lf\n  2: %.60lf\n  3: %.60lf\n  4: %.60lf\n", proc1, proc2, proc3, proc4);

	double mp1, mp2, mp3, mp4;
	double t1, t2, t3, t4, t5, t6, t7, t8;
	t1 = fmin(1., 1. - proc1 + 1.); t2 = fmin(1., 1. - proc1 + 0.);
	t3 = fmin(1., 1. - proc2 + 1.); t4 = fmin(1., 1. - proc2 + 0.);
	t5 = fmin(1., 1. - proc3 + 1.); t6 = fmin(1., 1. - proc3 + 0.);
	t7 = fmin(1., 1. - proc4 + 1.); t8 = fmin(1., 1. - proc4 + 0.);
	printf("===\n");
	printf("%.60f\n%.60f\n%.60f\n%.60f\n%.60f\n%.60f\n%.60f\n%.60f\n", t1, t2, t3, t4, t5, t6, t7, t8);
	printf("===\n");

	printf("mp1 = %.60f +\n      %.60f +\n      %.60f +\n      %.60f =\n      %.60f\n", t1, t4, t6, t8, t1 + t4 + t6 + t8);
	printf("mp2 = %.60f +\n      %.60f +\n      %.60f +\n      %.60f =\n      %.60f\n", t2, t3, t6, t8, t2 + t3 + t6 + t8);
	printf("mp3 = %.60f +\n      %.60f +\n      %.60f +\n      %.60f =\n      %.60f\n", t2, t4, t5, t8, t2 + t4 + t5 + t8);
	printf("mp4 = %.60f +\n      %.60f +\n      %.60f +\n      %.60f =\n      %.60f\n", t2, t4, t6, t7, t2 + t4 + t6 + t7);
	printf("%.60f\n", t4 + t6 + t8 + t1);

	mp1 = fmin(1., 1. - proc1 + 1.) + fmin(1., 1. - proc2 + 0.) + fmin(1., 1. - proc3 + 0.) + fmin(1., 1. - proc4 + 0.);
	mp2 = fmin(1., 1. - proc1 + 0.) + fmin(1., 1. - proc2 + 1.) + fmin(1., 1. - proc3 + 0.) + fmin(1., 1. - proc4 + 0.);
	mp3 = fmin(1., 1. - proc1 + 0.) + fmin(1., 1. - proc2 + 0.) + fmin(1., 1. - proc3 + 1.) + fmin(1., 1. - proc4 + 0.);
	mp4 = fmin(1., 1. - proc1 + 0.) + fmin(1., 1. - proc2 + 0.) + fmin(1., 1. - proc3 + 0.) + fmin(1., 1. - proc4 + 1.);
	printf("Modus ponens:\n  1: %.60f\n  2: %.60f\n  3: %.60f\n  4: %.60f\n", mp1, mp2, mp3, mp4);
	double m;
	m = fmax(mp1, mp2); m = fmax(m, mp3); m = fmax(m, mp4);
	printf("max = %.60f\n", m);
	printf("matching rules: ");
	if(m == mp1)
		printf(" 1 ");
	if(m == mp2)
		printf(" 2 ");
	if(m == mp3)
		printf(" 3 ");
	if(m == mp4)
		printf(" 4 ");
	printf("\n");


	return 0;
}
