function trim(stringToTrim)
{
	return stringToTrim.replace(/^\s+|\s+$/g,"");
}

function transform()
{
	var str = "";
	str = document.getElementById("formula").value;
	str = trim(str);
	if(str == "")
	{
		alert("Вы не ввели ничего");
		return false;
	}

	// replace cos/sin/tan/asin/acos/atan
	str = str.replace(/cos/gi, "Math.cos");
	str = str.replace(/sin/gi, "Math.sin");
	str = str.replace(/tan/gi, "Math.tan");
	str = str.replace(/acos/gi, "Math.acos$1");
	str = str.replace(/asin/gi, "Math.asin$1");
	str = str.replace(/atan/gi, "Math.atan$1");

	// sqrt
	str = str.replace(/sqrt(\((\d+\.?\d*|x)\))/gi, "Math.sqrt$1");

	// ln
	str = str.replace(/ln(\((\d+\.?\d*|x\)))/gi, "Math.log$1");

	// exp
	str = str.replace(/e\^(\d+|x)/gi, "Math.exp($1)");

	// pow
	str = str.replace(/(\d+\.?\d*|x)+\^(\d+)/gi, "Math.pow($1, $2)");

	return str;
}

function run()
{
	var beg_x = 0;
	var end_x = 10;
	var step = 0.2;

	var func = transform();
	if(!func){ return; }

	alert(func);

	var func_arr = new Array();
	for(var i = beg_x; i < end_x; i += step)
	{
		var computing_f = func.replace(/([+-\/* \(])x/gi, "$1" + i);
		func_arr.push(eval(computing_f));
	}

	var plot = $.jqplot('chart', [func_arr]);
}
