\documentclass[a4paper,12pt]{report}
\usepackage[utf8x]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{fixltx2e} % для индексов в обычном тексте
\usepackage{amsmath,amssymb,amsfonts,mathtext,cite,enumerate,float}

\usepackage{geometry}
\geometry{left=2cm}
\geometry{right=1.5cm}
\geometry{top=1cm}
\geometry{bottom=2cm}

\title{Геометрическое моделирование в САПР}

%%TODO: сделать титульник

\begin{document}

\tableofcontents

\chapter{Кривые в компьютерной графике}

\section{Интерполяционная кривая Лагранжа}
Пусть заданы точки на плоскости ($x_1$, $y_1$), ($x_2$, $y_2$), …, ($x_n$, $y_n$), при этом $i \ne j, x_i \ne x_j$, полином Лагранжа имеет вид:

\begin{equation}
\label{Lagranj}
	P(x) = \sum_{i = 1}^{n} y_i \prod^{n}_{\substack{j=1 \\
	j \ne i}} \frac{x - x_j}{x_i - x_j}
\end{equation}

\textbf{Преимущества:} гладкая.


\textbf{Недостатки:}
\begin{itemize}
	\item при $n > 3$ иногда появляется <<волна>> кривой;
	\item кривые всегда получаются простые.
\end{itemize}

%%Тут пример с картинкой

\section{Аппроксимация}
Аппроксимация --- это нахождение кривой, наиболее близко подходящей к заданному множеству точек.

\begin{equation}
\label{lineral_interpolation}
P = P_1(1 - t) + P_2t, \qquad 0 \le t \le 1
\end{equation}

Формула выше, представляет собой формулу линейной интерполяции, где P --- координаты, т.е.
\begin{eqnarray*}
	x & = & x_1(1 - t) + x_2t \\
	y & = & y_1(1 - t) + y_2t \\
	z & = & z_1(1 - t) + z_2t
\end{eqnarray*}

%%Здесь пример с картинкой

%%FIXME: отступы списков
\textbf{Достоинства:} 
\begin{itemize}
	\item прямая всегда начинается в точке $P_1$ и заканчивается в точке $P_n$;
	\item кривая гладкая;
	\item кривая всегда находится внутри ломанной, соединяющей все точки.
\end{itemize}

\textbf{Недостатки:}
\begin{itemize}
	\item для сложных кривых тяжело задавать точки аппроксимации.
\end{itemize}

\begin{equation}
\label{Bizier's_curve}
	P(t) = \sum \limits_{i = 0}^m C_m^i t^i(1-t)^{m -i} p_i,
\end{equation}
где $C_m^i = \frac{m!}{i!(m - i)!}$, при $0 \le t \le 1$

\section{Кривая Эрмита}
Пусть кривая описывается полиномом третьей степени вида:
\begin{eqnarray}
\label{polynom_for_hermits_curve}
	\begin{split}
		x(t) & = & a_x t^3 + b_x t^2 + c_x t + d_x \\
		y(t) & = & a_y t^3 + b_y t^2 + c_y t + d_y \\
		z(t) & = & a_z t^3 + b_z t^2 + c_z t + d_z
	\end{split}
\end{eqnarray}
где $ 0 \le t \le 1$

Производная для данной кривой имеет вид: $\frac {dx} {dt} = 3t^2 a_x + 2t b_x + c_x$. Аналогично для $\frac {dy} {dt}$ и $\frac {dx} {dt}$. Проивзодная показывает локальную кривизну в точке $t$.

В зависимости от того какие беруться исходные данные для построения кривой, получают, например, кривую Эрмита. Исходными данными для такой кривой являются:
\begin{itemize}
	\item начальная точка $P_1$;
	\item конечная точка $P_4$;
	\item начальная кривизна $R_1$;
	\item конечная кривизна $R4$.
\end{itemize}
По исходным данным очевидно, что:
\begin{eqnarray}
\label{hermits_curve_limits}
	\begin{split}
		x(0) & = & P_{1_{x}} \\
		x(1) & = & P_{4_{x}} \\
		\frac {dx} {dt} \mid_{t = 0} & = & R_1 \\
		\frac {dx} {dt} \mid_{t = 1} & = & R_4
	\end{split}
\end{eqnarray}

Выражение \eqref{polynom_for_hermits_curve} можно представить в векторной форме:
\begin{equation}
	x(t) = [t^3, t^2, t, 1] \cdot
	\begin{bmatrix}
		a \\
		b \\
		c \\
		d
	\end{bmatrix}_x
\end{equation}

Тогда согласно выражениям \eqref{hermits_curve_limits}:
\begin{eqnarray}
\label{hermits_conclusion:3}
	\begin{split}
		x(0) & = & \begin{bmatrix} 0~ 0~ 0~ 1 \end{bmatrix} C_x \\
		x(1) & = & \begin{bmatrix} 1~ 1~ 1~ 1 \end{bmatrix} C_x
	\end{split}
\end{eqnarray}

Производные имеют вид:
\begin{eqnarray}
\label{hermits_conclusion:4}
	\begin{split}
		x'(0) & = & \begin{bmatrix} 0~ 0~ 1~ 0 \end{bmatrix} C_x \\
		x'(1) & = & \begin{bmatrix} 3~ 2~ 1~ 0 \end{bmatrix} C_x
	\end{split}
\end{eqnarray}

Выражение \eqref{hermits_conclusion:3} можем объеденить с выражением \eqref{hermits_conclusion:4} в виде:
\begin{equation}
\label{hermits_conclusion:5}
	\begin{bmatrix}
		P_{1_{x}} \\
		P_{4_{x}} \\
		R_{1_{x}} \\
		R_{4_{x}}
	\end{bmatrix}
	=
	\begin{bmatrix}
		0~ 0~ 0~ 1 \\
		1~ 1~ 1~ 1 \\
		0~ 0~ 1~ 0 \\
		3~ 2~ 1~ 0
	\end{bmatrix}
	C_x
\end{equation}
Откуда:
\begin{equation}
\label{hermits_conclusion:6}
	C_x =
	\begin{bmatrix}
		&2& &-2& &1& &1& \\
		&-3& &3& &-2& &-1& \\
		&0& &0& &1& &0& \\
		&1& &0& &0& &0&
	\end{bmatrix}
	\cdot
	\begin{bmatrix}
		P_{1_{x}} \\
		P_{4_{x}} \\
		R_{1_{x}} \\
		R_{4_{x}}
	\end{bmatrix}
	= M_h \cdot G_{h_{x}}
\end{equation}

$M_h$ --- матрица Эрмита (англ. Hermit);
$G_{h_{x}}$ --- геометрический вектор Эрмита по параметру x.


Подставив выражение \eqref{hermits_conclusion:6} в формулу \eqref{hermits_conclusion:3}, получим:

\begin{eqnarray}
\label{hermits_conclusion:7}
	\begin{split}
		x(t) & = & T \cdot M_h \cdot G_{h_{x}} \\
		y(t) & = & T \cdot M_h \cdot G_{h_{y}} \\
		z(t) & = & T \cdot M_h \cdot G_{h_{z}} 
	\end{split}
\end{eqnarray}

В результате: $P(t) = T \cdot M_h \cdot G_h$


Вычислим $T \cdot M_h$:
\begin{equation*}
	T \cdot M_h =
	\begin{bmatrix}
		2t^3 - 3t^2 + 1, \quad
		-2t^3 + 3t^2, \quad
		t^3 - wt^2 + t, \quad
		t^3 - t^2
	\end{bmatrix}
\end{equation*}

Окончательно:
\begin{equation}
\label{hermits_curve}
	P(t) = P_1(2t^3 - 3t^2 + 1) + P_4(-2t^3 + 3t^2) + R_1(t^3 - wt^2 + t) + R_4(t^3 - t^2)
\end{equation}
$t \in [0; 1]$

\section{Сплайн Безье}
%%FIXME: рисунок
Касательные векторы в конечных точках задаются как $\overline{P_1P_2},$ $\overline{P_4P_3}$
Геометрический вектор Эрмита можно записать:
\begin{equation}
\label{geom_hermit_in_bezieur}
	G_h = \begin{bmatrix}
		P_1 \\
		P_4 \\
		R_1 \\
		R_4
		\end{bmatrix} =
		\begin{bmatrix}
			&1&  &0& &0&  &0& \\
			&0&  &0& &0&  &1& \\
			&-3& &3& &0&  &0& \\
			&0&  &0& &-3& &3&
		\end{bmatrix}
		\cdot
		\begin{bmatrix}
			P_1 \\
			P_4 \\
			R_1 \\
			R_4
		\end{bmatrix} %TODO: подпись снизу для последних двух матриц
\end{equation}

Что можно записать в матричном виде, как
\begin{eqnarray*}
	&P& = T \cdot M_h \cdot G_h = T \cdot M_h \cdot M_{h \rightarrow b} \cdot G_b = T M_B G_b \\
	&M_b& = M_h * M_{h \rightarrow b}
\end{eqnarray*}

$$
	M_b = 
	\begin{bmatrix}
		&-1& &3&  &-1& &1& \\
		&3&  &-1& &3&  &0& \\
		&-3& &3&  &0&  &0& \\
		&1&  &0&  &0&  &0&
	\end{bmatrix}
$$

Окончательно для сплайна Безье получаем:
\begin{equation}
\label{b_splain}
	P(t) = (1 - t)^3 P_1 + 3t(t - 1)^2 P_2 + 3t^2(1 - t) P_3 + t^3 P_4
\end{equation}

\end{document}
