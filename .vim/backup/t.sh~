#!/bin/bash 

# Запускать в каталоге исполнителя [составлено в соответствии с CMCS]
# Создаёт каталог _album_info, если такого нет и пихает туда все остальные каталоги

if [ "$1" ]; then
  workdir="$1"
else
  workdir="."
fi

function foo()
{
  cd "$1"
  for j in *;
  do
    echo "  Работаем с \"$j\""
    if [ -d "$j" ]; then
      if [ "$j" != "_album_info" ]; then
       echo -e "\e[31m    Это нестандартный каталог $j\e[0m";
       echo "    Перемещаем его в _album_info";
       mv "$j" "_album_info";
      else
        echo -e "\e[32m    Это стандартный каталог\e[0m"
      fi
    else
      echo -e "\e[33m     Ни хрена это не каталог\e[0m"
    fi
  done

  cd ".."
}

for i in * ;
do
  echo "Проверям \"$i\"";
  if [ -d "$i" ]; then
    if [ "$i" = "." ]; then
      echo " пропускаем";
    elif [ -d "$i/_album_info" ]; then
      echo "  каталог _album_info уже существует!"
      foo "$i"
    else
      echo "  создаём каталог _album_info"
      mkdir -p "$i/_album_info"
      foo "$i"
    fi
  else
    echo -e "\e[33m Ни хрена это не каталог\e[0m"
  fi
  echo ""

done
